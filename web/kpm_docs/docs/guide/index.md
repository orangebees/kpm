# 项目背景
目前的 KCL 语言只有单一的仓库管理包和模块，缺少灵活的包管理工具。目标是设计包管理机制，实现配套的管理工具。

预期
提供 KCL 包管理设计方案，扩展出包管理需要的功能函数（拉取、发布、校验、依赖分析等）

兼容目前的大库集中管理模式，同时支持去中心化的模块管理（Github独立仓库）。

为了提高响应速度，本地需要有相应的缓存机制。

需要检查包和当前 KCL 语言的版本兼容性。

可选：包文档和检索web服务

参考市面上的主流语言的包管理方案有

 Go Module

去中心化

平铺依赖

 npm

中心化

平铺依赖

pnpm

中心化

嵌套依赖目录

软硬链接解决嵌套依赖重复占用空间的问题

嵌套依赖与平铺依赖

嵌套依赖缺点

占用空间大

重复依赖

平铺依赖缺点

幽灵依赖问题

2.中心化与去中心化

由于go直接使用git地址作为包导入，可以较为容易的实现去中心化的包管理模式，并可以通过源代码自动查找依赖，而kcl采用点与路径做包名分割，直接支持此套包导入方案破坏性较大，不太适合此套方案。
所以需要使用一套同时具有中心化和去中心化的包管理方案

综合需求与当前较好的包管理实现方案，我提出了kpm包管理方案
首先每个包目录下面存在一个kpm.json文件，记录包的依赖信息
同时定一个明确通过包管理导入的约定

import external.pkg_name

例如原先通过复制konfig在同一目录下，导入语法为import base.pkg.kusion_models.kube.frontend，通过包管理依赖导入konfig,则语法为import external.konfig.base.pkg.kusion_models.kube.frontend
通过此简单的约定可以分割原先的目录依赖关系，即使不使用kpm包管理，将konfig 通过git clone在external /konfig目录下也是一样的依赖关系。通过此约定还能较为容易的禁止幽灵依赖问题，检测源码import包中是否包含一个个以上的external即可。

此约定也可较为容易的实现自动查找包，较为容易的实现类似于go mod tidy的功能。
通过包含git的仓库地址与版本信息，可以实现去中心化支持


# 当前开发进度
正在开发
# 目前存在问题
只能访问次级依赖，当依赖访问依赖的依赖时会发生错误，需要kcl解释器或者编译器做解析支持